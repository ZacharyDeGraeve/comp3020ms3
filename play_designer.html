<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./img/medal-solid.svg">
    <title>Sport Play Editor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
        }

        #editor-container {
            display: flex;
            height: 100%;
        }

        #sidebar {
            width: 10%;
            background-color: #f1f1f1;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column; /* Arrange icons and labels vertically */
            align-items: center; /* Center items horizontally */
        }

        .icon {
            width: 40px;
            height: 40px;
            margin-bottom: 5px; /* Increased margin between icons */
            cursor: pointer;
        }

        .label {
            font-size: 12px;
            text-align: center;
            margin-bottom: 20px;
        }

        #icons-label {
            font-size: 30px;
            font-weight: bold;
        }

        #whiteboard-container {
            flex-grow: 1;
            position: relative;
        }

        .whiteboard {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .whiteboard.active {
            display: block;
        }

        .whiteboard-icon {
            position: absolute;
            pointer-events: auto; /* Enable interaction with the icon */
        }

        #save-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1;
        }

        #save-modal input,
        #save-modal button {
            margin-bottom: 10px;
        }

        .drawing-mode {
            border: 2px solid #3498db;
        }

        #save-button {
            margin-top: auto; /* Push the Save button to the bottom of the sidebar */
            font-size: 16px; /* Increase the font size */
            font-weight: bold;
            padding: 10px; /* Add padding to the button */
        }

        #divider-bar {
            width: 100%;
            height: 1px;
            background-color: #ccc;
            margin-top: auto; /* Move the dividing bar above the Save button */
            margin-bottom: -300px; /* Leave some space below the dividing bar */
        }
    </style>
</head>
<body>

<div id="editor-container">
    <div id="sidebar">
        <div id="icons-label">Icons</div>
        <img class="icon" src="teammate.png" alt="Teammate" onclick="addIcon('teammate.png')">
        <span class="label">Teammate</span>

        <img class="icon" src="opponent.png" alt="Opponent" onclick="addIcon('opponent.png')">
        <span class="label">Opponent</span>

        <img class="icon" src="pass.png" alt="Pass" onclick="activateDrawingMode('pass')">
        <span class="label">Pass</span>

        <img class="icon" src="move.png" alt="Move" onclick="activateDrawingMode('move')">
        <span class="label">Move</span>

        <!-- Divider bar above the Save button -->
        <div id="divider-bar"></div>

        <!-- Save button at the bottom of the sidebar -->
        <button id="save-button" onclick="openSaveModal()">Save</button>

        <button id="save-button" onclick="location.href='library.html'">Back</button>
    </div>
    <div id="whiteboard-container">
        <img class="whiteboard soccer" src="SoccerGoalTop.png" alt="Soccer Field" onclick="placeIcon(event)">
        <img class="whiteboard hockey" src="HockeyGoalTop.png" alt="Hockey Rink" onclick="placeIcon(event)">
        <img class="whiteboard basketball active" src="BasketballNBAGoalTop.png" alt="Basketball Court" onclick="placeIcon(event)">
        <img class="whiteboard football" src="FootballNFLRedZoneOffense.png" alt="Football Field" onclick="placeIcon(event)">
    </div>
</div>

<div id="save-modal">
    <label for="play-description">Play Description:</label>
    <input type="text" id="play-description" required>
    <label for="play-tags">Tags:</label>
    <input type="text" id="play-tags" required>
    <button onclick="savePlay()">Save</button>
    <button onclick="saveAndShare()">Save & Share</button>
</div>

<script>
    let currentMode = null;

    function addIcon(iconSrc) {
        const icon = document.createElement("img");
        icon.src = iconSrc;
        icon.classList.add("whiteboard-icon");
        document.querySelector(".whiteboard.active").appendChild(icon);

        // Make the icon draggable
        dragElement(icon);
    }

    function placeIcon(event) {
        const icon = document.querySelector(".whiteboard-icon");
        if (icon) {
            const newIcon = icon.cloneNode(true);
            newIcon.style.position = "absolute";
            newIcon.style.left = `${event.clientX - 20}px`;
            newIcon.style.top = `${event.clientY - 20}px`;
            document.querySelector(".whiteboard.active").appendChild(newIcon);
            // Make the new icon draggable
            dragElement(newIcon);
        }
    }

    function activateDrawingMode(mode) {
        currentMode = mode;
        document.querySelector("#whiteboard-container").classList.add("drawing-mode");
    }

    function savePlay() {
        const description = document.getElementById("play-description").value;
        const tags = document.getElementById("play-tags").value;
        // Implement save logic here
        console.log(`Saving play: Description - ${description}, Tags - ${tags}`);
        closeSaveModal();
    }

    function saveAndShare() {
        savePlay();
        // Implement share logic here
        console.log("Sharing play");
    }

    function openSaveModal() {
        document.getElementById("save-modal").style.display = "block";
    }

    function closeSaveModal() {
        document.getElementById("play-description").value = "";
        document.getElementById("play-tags").value = "";
        document.getElementById("save-modal").style.display = "none";
    }

    // Close drawing mode on click
    document.querySelector("#whiteboard-container").addEventListener("click", function () {
        if (currentMode) {
            document.querySelector("#whiteboard-container").classList.remove("drawing-mode");
            currentMode = null;
        }
    });

    // Function to make an element draggable
    function dragElement(elmnt) {
        var pos1 = 0,
            pos2 = 0,
            pos3 = 0,
            pos4 = 0;
        elmnt.onmousedown = dragMouseDown;

        function dragMouseDown(e) {
            e = e || window.event;
            e.preventDefault();
            // get the mouse cursor position at startup:
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            // call a function whenever the cursor moves:
            document.onmousemove = elementDrag;
        }

        function elementDrag(e) {
            e = e || window.event;
            e.preventDefault();
            // calculate the new cursor position:
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            // set the element's new position:
            elmnt.style.top = elmnt.offsetTop - pos2 + "px";
            elmnt.style.left = elmnt.offsetLeft - pos1 + "px";
        }

        function closeDragElement() {
            // stop moving when the mouse button is released:
            document.onmouseup = null;
            document.onmousemove = null;
        }
    }
</script>

</body>
</html>
